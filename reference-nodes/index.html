
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://imperialcollegelondon.github.io/wsi/reference-nodes/">
      
      
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>API Reference - Nodes - WSIMOD docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.618322db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference-nodes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="WSIMOD docs" class="md-header__button md-logo" aria-label="WSIMOD docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            WSIMOD docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference - Nodes
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ImperialCollegeLondon/wsi" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="WSIMOD docs" class="md-nav__button md-logo" aria-label="WSIMOD docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    WSIMOD docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ImperialCollegeLondon/wsi" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../paper/paper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../how-to/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    How to guide
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../component-library/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Component library
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../wsimod-cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Command line interface
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dafni/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Run WSIMOD in DAFNI
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API reference
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../demo/scripts/quickstart_demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quickstart (.py)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../coverage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Coverage report
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/barneydobson/wsi" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    WSIMOD repository
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes" class="md-nav__link">
    <span class="md-ellipsis">
      
        nodes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node" class="md-nav__link">
    <span class="md-ellipsis">
      
        Node
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Node">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.__init_subclass__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init_subclass__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.apply_overrides" class="md-nav__link">
    <span class="md-ellipsis">
      
        apply_overrides
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.check_basic" class="md-nav__link">
    <span class="md-ellipsis">
      
        check_basic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.end_timestep" class="md-nav__link">
    <span class="md-ellipsis">
      
        end_timestep
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.get_connected" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_connected
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.get_data_input" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_data_input
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.get_direction_arcs" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_direction_arcs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.node_mass_balance" class="md-nav__link">
    <span class="md-ellipsis">
      
        node_mass_balance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.pull_check" class="md-nav__link">
    <span class="md-ellipsis">
      
        pull_check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.pull_check_basic" class="md-nav__link">
    <span class="md-ellipsis">
      
        pull_check_basic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.pull_check_deny" class="md-nav__link">
    <span class="md-ellipsis">
      
        pull_check_deny
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.pull_distributed" class="md-nav__link">
    <span class="md-ellipsis">
      
        pull_distributed
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.pull_set" class="md-nav__link">
    <span class="md-ellipsis">
      
        pull_set
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.pull_set_deny" class="md-nav__link">
    <span class="md-ellipsis">
      
        pull_set_deny
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.push_check" class="md-nav__link">
    <span class="md-ellipsis">
      
        push_check
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.push_check_accept" class="md-nav__link">
    <span class="md-ellipsis">
      
        push_check_accept
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.push_check_basic" class="md-nav__link">
    <span class="md-ellipsis">
      
        push_check_basic
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.push_check_deny" class="md-nav__link">
    <span class="md-ellipsis">
      
        push_check_deny
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.push_distributed" class="md-nav__link">
    <span class="md-ellipsis">
      
        push_distributed
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.push_set" class="md-nav__link">
    <span class="md-ellipsis">
      
        push_set
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.push_set_deny" class="md-nav__link">
    <span class="md-ellipsis">
      
        push_set_deny
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.query_handler" class="md-nav__link">
    <span class="md-ellipsis">
      
        query_handler
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.reinit" class="md-nav__link">
    <span class="md-ellipsis">
      
        reinit
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.total_in" class="md-nav__link">
    <span class="md-ellipsis">
      
        total_in
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wsimod.nodes.nodes.Node.total_out" class="md-nav__link">
    <span class="md-ellipsis">
      
        total_out
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="api-reference-nodes">API Reference - Nodes</h1>
<p>This section of the documentation provides a reference for the API of the nodes.nodes module.</p>


<div class="doc doc-object doc-module">



<a id="wsimod.nodes.nodes"></a>
    <div class="doc doc-contents first">

        <p>Created on Wed Apr  7 08:43:32 2021.</p>
<p>@author: Barney</p>
<p>Converted to totals on Thur Apr 21 2022</p>










<div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="wsimod.nodes.nodes.Node" class="doc doc-heading">
            <code>Node</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="WSIObj (wsimod.core.core.WSIObj)" href="../reference-core/#wsimod.core.core.WSIObj">WSIObj</a></code></p>










              <details class="mkdocstrings-source">
                <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Node</span><span class="p">(</span><span class="n">WSIObj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__init_subclass__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds all subclasses to the nodes registry.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init_subclass__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">in</span> <span class="n">NODES_REGISTRY</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Overwriting </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> in NODES_REGISTRY with </span><span class="si">{</span><span class="bp">cls</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">NODES_REGISTRY</span><span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">data_input_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Base class for CWSD nodes. Constructs all the necessary attributes for the</span>
<span class="sd">        node object.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): Name of node</span>
<span class="sd">            data_input_dict (dict, optional): Dictionary of data inputs relevant for</span>
<span class="sd">                the node. Keys are tuples where first value is the name of the</span>
<span class="sd">                variable to read from the dict and the second value is the time.</span>
<span class="sd">                Defaults to None.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; my_node = nodes.Node(name = &#39;london_river_junction&#39;)</span>

<span class="sd">        Key assumptions:</span>
<span class="sd">            - No physical processes represented, can be used as a junction.</span>

<span class="sd">        Input data and parameter requirements:</span>
<span class="sd">            - All nodes require a `name`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">node_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">NODES_REGISTRY</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="c1"># Default essential parameters</span>
        <span class="c1"># Dictionary of arcs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_arcs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out_arcs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_arcs_type</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="p">{}</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">node_types</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out_arcs_type</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="p">{}</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">node_types</span><span class="p">}</span>

        <span class="c1"># Set parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_input_dict</span> <span class="o">=</span> <span class="n">data_input_dict</span>

        <span class="c1"># Initiailise default handlers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pull_set_handler</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pull_distributed</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_set_handler</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">push_distributed</span><span class="p">(</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Node&quot;</span><span class="p">,</span> <span class="s2">&quot;River&quot;</span><span class="p">,</span> <span class="s2">&quot;Waste&quot;</span><span class="p">,</span> <span class="s2">&quot;Reservoir&quot;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pull_check_handler</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pull_check_basic</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">push_check_handler</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">push_check_basic</span><span class="p">(</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Node&quot;</span><span class="p">,</span> <span class="s2">&quot;River&quot;</span><span class="p">,</span> <span class="s2">&quot;Waste&quot;</span><span class="p">,</span> <span class="s2">&quot;Reservoir&quot;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Mass balance checking</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_balance_in</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">total_in</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_balance_out</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">total_out</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_balance_ds</span> <span class="o">=</span> <span class="p">[</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_vqip</span><span class="p">()]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">apply_overrides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">overrides</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply overrides to the node.</span>

<span class="sd">        The Node does not have any overwriteable parameters. So if any</span>
<span class="sd">        overrides are passed up to the node, this means that there are unused</span>
<span class="sd">        parameters from the Node subclass, which is flagged.</span>

<span class="sd">        Args:</span>
<span class="sd">            overrides (dict, optional): Dictionary of overrides. Defaults to {}.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># overrides data_input_dict</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wsimod.orchestration.model</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_csv</span>

        <span class="n">content</span> <span class="o">=</span> <span class="n">overrides</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;filename&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_input_dict</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">content</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Not recognised format for data_input_dict&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">overrides</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No override behaviour defined for: </span><span class="si">{</span><span class="n">overrides</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">total_in</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sum flow and pollutant amounts entering a node via in_arcs.</span>

<span class="sd">        Returns:</span>
<span class="sd">            in_ (dict): Summed VQIP of in_arcs</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; node_inflow = my_node.total_in()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">in_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_vqip</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">arc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_arcs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">in_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sum_vqip</span><span class="p">(</span><span class="n">in_</span><span class="p">,</span> <span class="n">arc</span><span class="o">.</span><span class="n">vqip_out</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">in_</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">total_out</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sum flow and pollutant amounts leaving a node via out_arcs.</span>

<span class="sd">        Returns:</span>
<span class="sd">            out_ (dict): Summed VQIP of out_arcs</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; node_outflow = my_node.total_out()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_vqip</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">arc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_arcs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">out_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sum_vqip</span><span class="p">(</span><span class="n">out_</span><span class="p">,</span> <span class="n">arc</span><span class="o">.</span><span class="n">vqip_in</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out_</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">node_mass_balance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrapper for core.py/WSIObj/mass_balance. Tracks change in mass balance.</span>

<span class="sd">        Returns:</span>
<span class="sd">            in_ (dict): A VQIP of the total from mass_balance_in functions</span>
<span class="sd">            ds_ (dict): A VQIP of the total from mass_balance_ds functions</span>
<span class="sd">            out_ (dict): A VQIP of the total from mass_balance_out functions</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; node_in, node_out, node_ds = my_node.node_mass_balance()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">in_</span><span class="p">,</span> <span class="n">ds_</span><span class="p">,</span> <span class="n">out_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass_balance</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">in_</span><span class="p">,</span> <span class="n">ds_</span><span class="p">,</span> <span class="n">out_</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">pull_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Receives pull set requests from arcs and passes request to query handler.</span>

<span class="sd">        Args:</span>
<span class="sd">            vqip (dict): the VQIP pull request (by default, only the &#39;volume&#39; key is</span>
<span class="sd">                needed).</span>
<span class="sd">            tag (str, optional): optional message to direct query_handler which pull</span>
<span class="sd">                function to call. Defaults to &#39;default&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (dict): VQIP received from query_handler</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; water_received = my_node.pull_set({&#39;volume&#39; : 10})</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_handler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pull_set_handler</span><span class="p">,</span> <span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">push_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Receives push set requests from arcs and passes request to query handler.</span>

<span class="sd">        Args:</span>
<span class="sd">            vqip (_type_): the VQIP push request</span>
<span class="sd">            tag (str, optional): optional message to direct query_handler which pull</span>
<span class="sd">                function to call. Defaults to &#39;default&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (dict): VQIP not received from query_handler</span>

<span class="sd">        Examples:</span>
<span class="sd">            water_not_pushed = my_node.push_set(wastewater_vqip)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_handler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_set_handler</span><span class="p">,</span> <span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">pull_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Receives pull check requests from arcs and passes request to query handler.</span>

<span class="sd">        Args:</span>
<span class="sd">            vqip (dict, optional): the VQIP pull check (by default, only the</span>
<span class="sd">                &#39;volume&#39; key is used). Defaults to None, which returns all available</span>
<span class="sd">                water to pull.</span>
<span class="sd">            tag (str, optional): optional message to direct query_handler which pull</span>
<span class="sd">                function to call. Defaults to &#39;default&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (dict): VQIP available from query_handler</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; water_available = my_node.pull_check({&#39;volume&#39; : 10})</span>
<span class="sd">            &gt;&gt;&gt; total_water_available = my_node.pull_check()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_handler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pull_check_handler</span><span class="p">,</span> <span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">push_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Receives push check requests from arcs and passes request to query handler.</span>

<span class="sd">        Args:</span>
<span class="sd">            vqip (dict, optional): the VQIP push check. Defaults to None, which</span>
<span class="sd">                returns all available capacity to push</span>
<span class="sd">            tag (str, optional): optional message to direct query_handler which pull</span>
<span class="sd">                function to call. Defaults to &#39;default&#39;</span>

<span class="sd">        Returns:</span>
<span class="sd">            (dict): VQIP available to push from query_handler</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; total_available_push_capacity = my_node.push_check()</span>
<span class="sd">            &gt;&gt;&gt; available_push_capacity = my_node.push_check(wastewater_vqip)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_handler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_check_handler</span><span class="p">,</span> <span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_direction_arcs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Identify arcs to/from all attached nodes in a given direction.</span>

<span class="sd">        Args:</span>
<span class="sd">            direction (str): can be either &#39;pull&#39; or &#39;push&#39; to send checks to</span>
<span class="sd">                receiving or contributing nodes</span>
<span class="sd">            of_type (str or list) : optional, can be specified to send checks only</span>
<span class="sd">                to nodes of a given type (must be a subclass in nodes.py)</span>

<span class="sd">        Returns:</span>
<span class="sd">            f (str): Either &#39;send_pull_check&#39; or &#39;send_push_check&#39; depending on</span>
<span class="sd">                direction</span>
<span class="sd">            arcs (list): List of arc objects</span>

<span class="sd">        Raises:</span>
<span class="sd">            Message if no direction is specified</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; arcs_to_push_to = my_node.get_direction_arcs(&#39;push&#39;)</span>
<span class="sd">            &gt;&gt;&gt; arcs_to_pull_from = my_node.get_direction_arcs(&#39;pull&#39;)</span>
<span class="sd">            &gt;&gt;&gt; arcs_from_reservoirs = my_node.get_direction_arcs(&#39;pull&#39;, of_type =</span>
<span class="sd">                &#39;Reservoir&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">of_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Return all arcs</span>
            <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s2">&quot;pull&quot;</span><span class="p">:</span>
                <span class="n">arcs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_arcs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                <span class="n">f</span> <span class="o">=</span> <span class="s2">&quot;send_pull_check&quot;</span>
            <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="s2">&quot;push&quot;</span><span class="p">:</span>
                <span class="n">arcs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_arcs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                <span class="n">f</span> <span class="o">=</span> <span class="s2">&quot;send_push_check&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No direction&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">of_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">of_type</span> <span class="o">=</span> <span class="p">[</span><span class="n">of_type</span><span class="p">]</span>

            <span class="c1"># Assign arcs/function based on parameters</span>
            <span class="n">arcs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s2">&quot;pull&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">type_</span> <span class="ow">in</span> <span class="n">of_type</span><span class="p">:</span>
                    <span class="n">arcs</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_arcs_type</span><span class="p">[</span><span class="n">type_</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                <span class="n">f</span> <span class="o">=</span> <span class="s2">&quot;send_pull_check&quot;</span>
            <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="s2">&quot;push&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">type_</span> <span class="ow">in</span> <span class="n">of_type</span><span class="p">:</span>
                    <span class="n">arcs</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_arcs_type</span><span class="p">[</span><span class="n">type_</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                <span class="n">f</span> <span class="o">=</span> <span class="s2">&quot;send_push_check&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No direction&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">arcs</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;pull&quot;</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Send push/pull checks to all attached arcs in a given direction.</span>

<span class="sd">        Args:</span>
<span class="sd">            direction (str, optional): The type of check to send to all attached</span>
<span class="sd">                nodes. Can be &#39;push&#39; or &#39;pull&#39;. The default is &#39;pull&#39;.</span>
<span class="sd">            of_type (str or list) : optional, can be specified to send checks only</span>
<span class="sd">                to nodes of a given type (must be a subclass in nodes.py)</span>
<span class="sd">            tag (str, optional): optional message to direct query_handler which pull</span>
<span class="sd">                function to call. Defaults to &#39;default&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            connected (dict) :</span>
<span class="sd">                Dictionary containing keys:</span>
<span class="sd">                &#39;avail&#39;: (float) - total available volume for push/pull</span>
<span class="sd">                &#39;priority&#39;: (float) - total (availability * preference)</span>
<span class="sd">                                    of attached arcs</span>
<span class="sd">                &#39;allocation&#39;: (dict) - contains all attached arcs in specified</span>
<span class="sd">                                direction and respective (availability * preference)</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; vqip_available_to_pull = my_node.get_direction_arcs()</span>
<span class="sd">            &gt;&gt;&gt; vqip_available_to_push = my_node.get_direction_arcs(&#39;push&#39;)</span>
<span class="sd">            &gt;&gt;&gt; avail_reservoir_vqip = my_node.get_direction_arcs(&#39;pull&#39;,</span>
<span class="sd">                                                          of_type = &#39;Reservoir&#39;)</span>
<span class="sd">            &gt;&gt;&gt; avail_sewer_push_to_sewers = my_node.get_direction_arcs(&#39;push&#39;,</span>
<span class="sd">                                                                of_type = &#39;Sewer&#39;,</span>
<span class="sd">                                                                tag = &#39;Sewer&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialise connected dict</span>
        <span class="n">connected</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;avail&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;priority&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;allocation&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="p">{}}</span>

        <span class="c1"># Get arcs</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">arcs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_direction_arcs</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="n">of_type</span><span class="p">)</span>

        <span class="c1"># Iterate over arcs, updating connected dict</span>
        <span class="k">for</span> <span class="n">arc</span> <span class="ow">in</span> <span class="n">arcs</span><span class="p">:</span>
            <span class="n">avail</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">arc</span><span class="p">,</span> <span class="n">f</span><span class="p">)(</span><span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">avail</span> <span class="o">&lt;</span> <span class="n">constants</span><span class="o">.</span><span class="n">FLOAT_ACCURACY</span><span class="p">:</span>
                <span class="n">avail</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Improves convergence</span>
            <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;avail&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">avail</span>
            <span class="n">preference</span> <span class="o">=</span> <span class="n">arc</span><span class="o">.</span><span class="n">preference</span>
            <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;priority&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">avail</span> <span class="o">*</span> <span class="n">preference</span>
            <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;allocation&quot;</span><span class="p">][</span><span class="n">arc</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">avail</span> <span class="o">*</span> <span class="n">preference</span>
            <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">][</span><span class="n">arc</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">avail</span>

        <span class="k">return</span> <span class="n">connected</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">query_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">handler</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sends all push/pull requests/checks using the handler (i.e., ensures the</span>
<span class="sd">        correct function is used that lines up with &#39;tag&#39;).</span>

<span class="sd">        Args:</span>
<span class="sd">            handler (dict): contains all push/pull requests for various tags</span>
<span class="sd">            ip (vqip): the vqip request</span>
<span class="sd">            tag (str): describes what type of push/pull request should be called</span>

<span class="sd">        Returns:</span>
<span class="sd">            (dict): the VQIP reply from push/pull request</span>

<span class="sd">        Raises:</span>
<span class="sd">            Message if no functions are defined for tag and if request/check</span>
<span class="sd">            function fails</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">handler</span><span class="p">[</span><span class="n">tag</span><span class="p">](</span><span class="n">ip</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">handler</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No functions defined for &quot;</span> <span class="o">+</span> <span class="n">tag</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">handler</span><span class="p">[</span><span class="n">tag</span><span class="p">](</span><span class="n">ip</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Some other error&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">handler</span><span class="p">[</span><span class="n">tag</span><span class="p">](</span><span class="n">ip</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">pull_distributed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Send pull requests to all (or specified by type) nodes connecting to self.</span>
<span class="sd">        Iterate until request is met or maximum iterations are hit. Streamlines if only</span>
<span class="sd">        one in_arc exists.</span>

<span class="sd">        Args:</span>
<span class="sd">            vqip (dict): Total amount to pull (by default, only the</span>
<span class="sd">                &#39;volume&#39; key is used)</span>
<span class="sd">            of_type (str or list) : optional, can be specified to send checks only</span>
<span class="sd">                to nodes of a given type (must be a subclass in nodes.py)</span>
<span class="sd">            tag (str, optional): optional message to direct query_handler which pull</span>
<span class="sd">                function to call. Defaults to &#39;default&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pulled (dict): VQIP of combined pulled water</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_arcs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># If only one in_arc, just pull from that</span>
            <span class="k">if</span> <span class="n">of_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">pulled</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_arcs</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">send_pull_request</span><span class="p">(</span>
                    <span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span>
                <span class="p">[</span><span class="n">x</span> <span class="ow">in</span> <span class="n">of_type</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_arcs_type</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">pulled</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_arcs</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">send_pull_request</span><span class="p">(</span>
                    <span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># No viable out arcs</span>
                <span class="n">pulled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_vqip</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Pull in proportion from connected by priority</span>

            <span class="c1"># Initialise pulled, deficit, connected, iter_</span>
            <span class="n">pulled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_vqip</span><span class="p">()</span>
            <span class="n">deficit</span> <span class="o">=</span> <span class="n">vqip</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span>
            <span class="n">connected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connected</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;pull&quot;</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="n">of_type</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
            <span class="n">iter_</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># Iterate over sending nodes until deficit met</span>
            <span class="k">while</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">deficit</span> <span class="o">&gt;</span> <span class="n">constants</span><span class="o">.</span><span class="n">FLOAT_ACCURACY</span><span class="p">)</span>
                <span class="o">&amp;</span> <span class="p">(</span><span class="n">connected</span><span class="p">[</span><span class="s2">&quot;avail&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">constants</span><span class="o">.</span><span class="n">FLOAT_ACCURACY</span><span class="p">)</span>
            <span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">iter_</span> <span class="o">&lt;</span> <span class="n">constants</span><span class="o">.</span><span class="n">MAXITER</span><span class="p">):</span>
                <span class="c1"># Pull from connected</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">allocation</span> <span class="ow">in</span> <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;allocation&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">received</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_arcs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">send_pull_request</span><span class="p">(</span>
                        <span class="p">{</span><span class="s2">&quot;volume&quot;</span><span class="p">:</span> <span class="n">deficit</span> <span class="o">*</span> <span class="n">allocation</span> <span class="o">/</span> <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;priority&quot;</span><span class="p">]},</span>
                        <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">pulled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sum_vqip</span><span class="p">(</span><span class="n">pulled</span><span class="p">,</span> <span class="n">received</span><span class="p">)</span>

                <span class="c1"># Update deficit, connected and iter_</span>
                <span class="n">deficit</span> <span class="o">=</span> <span class="n">vqip</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">pulled</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span>
                <span class="n">connected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connected</span><span class="p">(</span>
                    <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;pull&quot;</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="n">of_type</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span>
                <span class="p">)</span>
                <span class="n">iter_</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="n">iter_</span> <span class="o">==</span> <span class="n">constants</span><span class="o">.</span><span class="n">MAXITER</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maxiter reached in </span><span class="si">{0}</span><span class="s2"> at </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">pulled</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">push_distributed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Send push requests to all (or specified by type) nodes connecting to self.</span>
<span class="sd">        Iterate until request is met or maximum iterations are hit. Streamlines if only</span>
<span class="sd">        one in_arc exists.</span>

<span class="sd">        Args:</span>
<span class="sd">            vqip (dict): Total amount to push</span>
<span class="sd">            of_type (str or list) : optional, can be specified to send checks only</span>
<span class="sd">                to nodes of a given type (must be a subclass in nodes.py)</span>
<span class="sd">            tag (str, optional): optional message to direct query_handler which pull</span>
<span class="sd">                function to call. Defaults to &#39;default&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            not_pushed_ (dict): VQIP of water that cannot be pushed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_arcs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># If only one out_arc, just send the water down that</span>
            <span class="k">if</span> <span class="n">of_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">not_pushed_</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_arcs</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">send_push_request</span><span class="p">(</span>
                    <span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span>
                <span class="p">[</span><span class="n">x</span> <span class="ow">in</span> <span class="n">of_type</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_arcs_type</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">not_pushed_</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_arcs</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">send_push_request</span><span class="p">(</span>
                    <span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># No viable out arcs</span>
                <span class="n">not_pushed_</span> <span class="o">=</span> <span class="n">vqip</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Push in proportion to connected by priority</span>
            <span class="c1"># Initialise pushed, deficit, connected, iter_</span>
            <span class="n">not_pushed</span> <span class="o">=</span> <span class="n">vqip</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span>
            <span class="n">not_pushed_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy_vqip</span><span class="p">(</span><span class="n">vqip</span><span class="p">)</span>
            <span class="n">connected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connected</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;push&quot;</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="n">of_type</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
            <span class="n">iter_</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">not_pushed</span> <span class="o">&gt;</span> <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;avail&quot;</span><span class="p">]:</span>
                <span class="c1"># If more water than can be pushed, ignore preference and allocate all</span>
                <span class="c1">#   available based on capacity</span>
                <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;priority&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;avail&quot;</span><span class="p">]</span>
                <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;allocation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>

            <span class="c1"># Iterate over receiving nodes until sent</span>
            <span class="k">while</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">not_pushed</span> <span class="o">&gt;</span> <span class="n">constants</span><span class="o">.</span><span class="n">FLOAT_ACCURACY</span><span class="p">)</span>
                <span class="o">&amp;</span> <span class="p">(</span><span class="n">connected</span><span class="p">[</span><span class="s2">&quot;avail&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">constants</span><span class="o">.</span><span class="n">FLOAT_ACCURACY</span><span class="p">)</span>
                <span class="o">&amp;</span> <span class="p">(</span><span class="n">iter_</span> <span class="o">&lt;</span> <span class="n">constants</span><span class="o">.</span><span class="n">MAXITER</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="c1"># Push to connected</span>
                <span class="n">amount_to_push</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">connected</span><span class="p">[</span><span class="s2">&quot;avail&quot;</span><span class="p">],</span> <span class="n">not_pushed</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">allocation</span> <span class="ow">in</span> <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;allocation&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">to_send</span> <span class="o">=</span> <span class="n">amount_to_push</span> <span class="o">*</span> <span class="n">allocation</span> <span class="o">/</span> <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;priority&quot;</span><span class="p">]</span>
                    <span class="n">to_send</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_change_vqip</span><span class="p">(</span><span class="n">not_pushed_</span><span class="p">,</span> <span class="n">to_send</span><span class="p">)</span>
                    <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_arcs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">send_push_request</span><span class="p">(</span><span class="n">to_send</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>

                    <span class="n">sent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_vqip</span><span class="p">(</span><span class="n">to_send</span><span class="p">,</span> <span class="n">reply</span><span class="p">)</span>
                    <span class="n">not_pushed_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_vqip</span><span class="p">(</span><span class="n">not_pushed_</span><span class="p">,</span> <span class="n">sent</span><span class="p">)</span>

                <span class="n">not_pushed</span> <span class="o">=</span> <span class="n">not_pushed_</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span>
                <span class="n">connected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connected</span><span class="p">(</span>
                    <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;push&quot;</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="n">of_type</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span>
                <span class="p">)</span>
                <span class="n">iter_</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="n">iter_</span> <span class="o">==</span> <span class="n">constants</span><span class="o">.</span><span class="n">MAXITER</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maxiter reached in </span><span class="si">{0}</span><span class="s2"> at </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">not_pushed_</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_basic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generic function that conveys a pull or push check onwards to connected</span>
<span class="sd">        nodes. It is the default behaviour that treats a node like a junction.</span>

<span class="sd">        Args:</span>
<span class="sd">            direction (str): can be either &#39;pull&#39; or &#39;push&#39; to send checks to</span>
<span class="sd">                receiving or contributing nodes</span>
<span class="sd">            vqip (dict, optional): The VQIP to check. Defaults to None (if pulling</span>
<span class="sd">                this will return available water to pull, if pushing then available</span>
<span class="sd">                capacity to push).</span>
<span class="sd">            of_type (str or list) : optional, can be specified to send checks only</span>
<span class="sd">                to nodes of a given type (must be a subclass in nodes.py)</span>
<span class="sd">            tag (str, optional): optional message to direct query_handler which pull</span>
<span class="sd">                function to call. Defaults to &#39;default&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            avail (dict): VQIP responses summed over all requests</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span><span class="p">,</span> <span class="n">arcs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_direction_arcs</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="n">of_type</span><span class="p">)</span>

        <span class="c1"># Iterate over arcs, updating total</span>
        <span class="n">avail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_vqip</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">arc</span> <span class="ow">in</span> <span class="n">arcs</span><span class="p">:</span>
            <span class="n">avail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sum_vqip</span><span class="p">(</span><span class="n">avail</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">arc</span><span class="p">,</span> <span class="n">f</span><span class="p">)(</span><span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">vqip</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">avail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_change_vqip</span><span class="p">(</span><span class="n">avail</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">avail</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">],</span> <span class="n">vqip</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">avail</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">pull_check_basic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Default node check behaviour that treats a node like a junction. Water</span>
<span class="sd">        available to pull is just the water available to pull from upstream connected</span>
<span class="sd">        nodes.</span>

<span class="sd">        Args:</span>
<span class="sd">            vqip (dict, optional): VQIP from handler of amount to pull check</span>
<span class="sd">                (by default, only the &#39;volume&#39; key is used). Defaults to None (which</span>
<span class="sd">                returns all availalbe water to pull).</span>
<span class="sd">            of_type (str or list) : optional, can be specified to send checks only</span>
<span class="sd">                to nodes of a given type (must be a subclass in nodes.py)</span>
<span class="sd">            tag (str, optional): optional message to direct query_handler which pull</span>
<span class="sd">                function to call. Defaults to &#39;default&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (dict): VQIP check response of upstream nodes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_basic</span><span class="p">(</span><span class="s2">&quot;pull&quot;</span><span class="p">,</span> <span class="n">vqip</span><span class="p">,</span> <span class="n">of_type</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">push_check_basic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Default node check behaviour that treats a node like a junction. Water</span>
<span class="sd">        available to push is just the water available to push to downstream connected</span>
<span class="sd">        nodes.</span>

<span class="sd">        Args:</span>
<span class="sd">            vqip (dict, optional): VQIP from handler of amount to push check.</span>
<span class="sd">                Defaults to None (which returns all available capacity to push).</span>
<span class="sd">            of_type (str or list) : optional, can be specified to send checks only</span>
<span class="sd">                to nodes of a given type (must be a subclass in nodes.py)</span>
<span class="sd">            tag (str, optional): optional message to direct query_handler which pull</span>
<span class="sd">                function to call. Defaults to &#39;default&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (dict): VQIP check response of downstream nodes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_basic</span><span class="p">(</span><span class="s2">&quot;push&quot;</span><span class="p">,</span> <span class="n">vqip</span><span class="p">,</span> <span class="n">of_type</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">pull_set_deny</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Responds that no water is available to pull from a request.</span>

<span class="sd">        Args:</span>
<span class="sd">            vqip (dict): A VQIP amount of water requested (ignored)</span>

<span class="sd">        Returns:</span>
<span class="sd">            (dict): An empty VQIP indicated no water was pulled</span>

<span class="sd">        Raises:</span>
<span class="sd">            Message when called, since it would usually occur if a model is</span>
<span class="sd">            improperly connected</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Attempted pull set from deny&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_vqip</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">pull_check_deny</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Responds that no water is available to pull from a check.</span>

<span class="sd">        Args:</span>
<span class="sd">            vqip (dict): A VQIP amount of water requested (ignored)</span>

<span class="sd">        Returns:</span>
<span class="sd">            (dict): An empty VQIP indicated no water was pulled</span>

<span class="sd">        Raises:</span>
<span class="sd">            Message when called, since it would usually occur if a model is</span>
<span class="sd">            improperly connected</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Attempted pull check from deny&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_vqip</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">push_set_deny</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Responds that no water is available to push in a request.</span>

<span class="sd">        Args:</span>
<span class="sd">            vqip (dict): A VQIP amount of water to push</span>

<span class="sd">        Returns:</span>
<span class="sd">            vqip (dict): Returns the request indicating no water was pushed</span>

<span class="sd">        Raises:</span>
<span class="sd">            Message when called, since it would usually occur if a model is</span>
<span class="sd">            improperly connected</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Attempted push set to deny&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">vqip</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">push_check_deny</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Responds that no water is available to push in a check.</span>

<span class="sd">        Args:</span>
<span class="sd">            vqip (dict): A VQIP amount of water to push check (ignored)</span>

<span class="sd">        Returns:</span>
<span class="sd">            (dict): An empty VQIP indicated no capacity for pushes exists</span>

<span class="sd">        Raises:</span>
<span class="sd">            Message when called, since it would usually occur if a model is</span>
<span class="sd">            improperly connected</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Attempted push check to deny&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_vqip</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">push_check_accept</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Push check function that accepts all water.</span>

<span class="sd">        Args:</span>
<span class="sd">            vqip (dict, optional): A VQIP that has been pushed (ignored)</span>

<span class="sd">        Returns:</span>
<span class="sd">            (dict): VQIP or an unbounded capacity, indicating all water can be received</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">vqip</span><span class="p">:</span>
            <span class="n">vqip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_vqip</span><span class="p">()</span>
            <span class="n">vqip</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">UNBOUNDED_CAPACITY</span>
        <span class="k">return</span> <span class="n">vqip</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_data_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read data from data_input_dict. Keys are tuples with the first entry as the</span>
<span class="sd">        variable to read and second entry the time.</span>

<span class="sd">        Args:</span>
<span class="sd">            var (str): Name of variable</span>

<span class="sd">        Returns:</span>
<span class="sd">            Data read</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_input_dict</span><span class="p">[(</span><span class="n">var</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">end_timestep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Empty function intended to be called at the end of every timestep.</span>

<span class="sd">        Subclasses will overwrite this functions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reinit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Empty function to be written if reinitialisation capability is added.&quot;&quot;&quot;</span>
        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">data_input_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Base class for CWSD nodes. Constructs all the necessary attributes for the
node object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of node</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_input_dict</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of data inputs relevant for
the node. Keys are tuples where first value is the name of the
variable to read from the dict and the second value is the time.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">my_node</span> <span class="o">=</span> <span class="n">nodes</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;london_river_junction&#39;</span><span class="p">)</span>
</code></pre></div>


<details class="key-assumptions" open>
  <summary>Key assumptions</summary>
  <ul>
<li>No physical processes represented, can be used as a junction.</li>
</ul>
</details>

<details class="input-data-and-parameter-requirements" open>
  <summary>Input data and parameter requirements</summary>
  <ul>
<li>All nodes require a <code>name</code></li>
</ul>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">data_input_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for CWSD nodes. Constructs all the necessary attributes for the</span>
<span class="sd">    node object.</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): Name of node</span>
<span class="sd">        data_input_dict (dict, optional): Dictionary of data inputs relevant for</span>
<span class="sd">            the node. Keys are tuples where first value is the name of the</span>
<span class="sd">            variable to read from the dict and the second value is the time.</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; my_node = nodes.Node(name = &#39;london_river_junction&#39;)</span>

<span class="sd">    Key assumptions:</span>
<span class="sd">        - No physical processes represented, can be used as a junction.</span>

<span class="sd">    Input data and parameter requirements:</span>
<span class="sd">        - All nodes require a `name`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">node_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">NODES_REGISTRY</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="c1"># Default essential parameters</span>
    <span class="c1"># Dictionary of arcs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">in_arcs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">out_arcs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">in_arcs_type</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="p">{}</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">node_types</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">out_arcs_type</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="p">{}</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">node_types</span><span class="p">}</span>

    <span class="c1"># Set parameters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_input_dict</span> <span class="o">=</span> <span class="n">data_input_dict</span>

    <span class="c1"># Initiailise default handlers</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pull_set_handler</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pull_distributed</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">push_set_handler</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">push_distributed</span><span class="p">(</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Node&quot;</span><span class="p">,</span> <span class="s2">&quot;River&quot;</span><span class="p">,</span> <span class="s2">&quot;Waste&quot;</span><span class="p">,</span> <span class="s2">&quot;Reservoir&quot;</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pull_check_handler</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pull_check_basic</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">push_check_handler</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">push_check_basic</span><span class="p">(</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Node&quot;</span><span class="p">,</span> <span class="s2">&quot;River&quot;</span><span class="p">,</span> <span class="s2">&quot;Waste&quot;</span><span class="p">,</span> <span class="s2">&quot;Reservoir&quot;</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="p">}</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="c1"># Mass balance checking</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mass_balance_in</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">total_in</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mass_balance_out</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">total_out</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mass_balance_ds</span> <span class="o">=</span> <span class="p">[</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_vqip</span><span class="p">()]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.__init_subclass__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__init_subclass__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Adds all subclasses to the nodes registry.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__init_subclass__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds all subclasses to the nodes registry.&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init_subclass__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">in</span> <span class="n">NODES_REGISTRY</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Overwriting </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> in NODES_REGISTRY with </span><span class="si">{</span><span class="bp">cls</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">NODES_REGISTRY</span><span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.apply_overrides" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_overrides</span><span class="p">(</span><span class="n">overrides</span><span class="o">=</span><span class="p">{})</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Apply overrides to the node.</p>
<p>The Node does not have any overwriteable parameters. So if any
overrides are passed up to the node, this means that there are unused
parameters from the Node subclass, which is flagged.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>overrides</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of overrides. Defaults to {}.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">apply_overrides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">overrides</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply overrides to the node.</span>

<span class="sd">    The Node does not have any overwriteable parameters. So if any</span>
<span class="sd">    overrides are passed up to the node, this means that there are unused</span>
<span class="sd">    parameters from the Node subclass, which is flagged.</span>

<span class="sd">    Args:</span>
<span class="sd">        overrides (dict, optional): Dictionary of overrides. Defaults to {}.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># overrides data_input_dict</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wsimod.orchestration.model</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_csv</span>

    <span class="n">content</span> <span class="o">=</span> <span class="n">overrides</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;filename&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_input_dict</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">content</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Not recognised format for data_input_dict&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">overrides</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No override behaviour defined for: </span><span class="si">{</span><span class="n">overrides</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.check_basic" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_basic</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generic function that conveys a pull or push check onwards to connected
nodes. It is the default behaviour that treats a node like a junction.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>direction</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>can be either 'pull' or 'push' to send checks to
receiving or contributing nodes</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>vqip</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The VQIP to check. Defaults to None (if pulling
this will return available water to pull, if pushing then available
capacity to push).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>of_type (str or list) </code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional, can be specified to send checks only
to nodes of a given type (must be a subclass in nodes.py)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tag</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional message to direct query_handler which pull
function to call. Defaults to 'default'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;default&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>avail</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>VQIP responses summed over all requests</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_basic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generic function that conveys a pull or push check onwards to connected</span>
<span class="sd">    nodes. It is the default behaviour that treats a node like a junction.</span>

<span class="sd">    Args:</span>
<span class="sd">        direction (str): can be either &#39;pull&#39; or &#39;push&#39; to send checks to</span>
<span class="sd">            receiving or contributing nodes</span>
<span class="sd">        vqip (dict, optional): The VQIP to check. Defaults to None (if pulling</span>
<span class="sd">            this will return available water to pull, if pushing then available</span>
<span class="sd">            capacity to push).</span>
<span class="sd">        of_type (str or list) : optional, can be specified to send checks only</span>
<span class="sd">            to nodes of a given type (must be a subclass in nodes.py)</span>
<span class="sd">        tag (str, optional): optional message to direct query_handler which pull</span>
<span class="sd">            function to call. Defaults to &#39;default&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        avail (dict): VQIP responses summed over all requests</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">arcs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_direction_arcs</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="n">of_type</span><span class="p">)</span>

    <span class="c1"># Iterate over arcs, updating total</span>
    <span class="n">avail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_vqip</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">arc</span> <span class="ow">in</span> <span class="n">arcs</span><span class="p">:</span>
        <span class="n">avail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sum_vqip</span><span class="p">(</span><span class="n">avail</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">arc</span><span class="p">,</span> <span class="n">f</span><span class="p">)(</span><span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">vqip</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">avail</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_change_vqip</span><span class="p">(</span><span class="n">avail</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">avail</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">],</span> <span class="n">vqip</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">avail</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.end_timestep" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">end_timestep</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Empty function intended to be called at the end of every timestep.</p>
<p>Subclasses will overwrite this functions.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">end_timestep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Empty function intended to be called at the end of every timestep.</span>

<span class="sd">    Subclasses will overwrite this functions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.get_connected" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_connected</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;pull&#39;</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Send push/pull checks to all attached arcs in a given direction.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>direction</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of check to send to all attached
nodes. Can be 'push' or 'pull'. The default is 'pull'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;pull&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>of_type (str or list) </code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional, can be specified to send checks only
to nodes of a given type (must be a subclass in nodes.py)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tag</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional message to direct query_handler which pull
function to call. Defaults to 'default'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;default&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>connected (dict) :
Dictionary containing keys:
'avail': (float) - total available volume for push/pull
'priority': (float) - total (availability * preference)
                    of attached arcs
'allocation': (dict) - contains all attached arcs in specified
                direction and respective (availability * preference)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">vqip_available_to_pull</span> <span class="o">=</span> <span class="n">my_node</span><span class="o">.</span><span class="n">get_direction_arcs</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vqip_available_to_push</span> <span class="o">=</span> <span class="n">my_node</span><span class="o">.</span><span class="n">get_direction_arcs</span><span class="p">(</span><span class="s1">&#39;push&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avail_reservoir_vqip</span> <span class="o">=</span> <span class="n">my_node</span><span class="o">.</span><span class="n">get_direction_arcs</span><span class="p">(</span><span class="s1">&#39;pull&#39;</span><span class="p">,</span>
<span class="go">                                              of_type = &#39;Reservoir&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avail_sewer_push_to_sewers</span> <span class="o">=</span> <span class="n">my_node</span><span class="o">.</span><span class="n">get_direction_arcs</span><span class="p">(</span><span class="s1">&#39;push&#39;</span><span class="p">,</span>
<span class="go">                                                    of_type = &#39;Sewer&#39;,</span>
<span class="go">                                                    tag = &#39;Sewer&#39;)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;pull&quot;</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Send push/pull checks to all attached arcs in a given direction.</span>

<span class="sd">    Args:</span>
<span class="sd">        direction (str, optional): The type of check to send to all attached</span>
<span class="sd">            nodes. Can be &#39;push&#39; or &#39;pull&#39;. The default is &#39;pull&#39;.</span>
<span class="sd">        of_type (str or list) : optional, can be specified to send checks only</span>
<span class="sd">            to nodes of a given type (must be a subclass in nodes.py)</span>
<span class="sd">        tag (str, optional): optional message to direct query_handler which pull</span>
<span class="sd">            function to call. Defaults to &#39;default&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        connected (dict) :</span>
<span class="sd">            Dictionary containing keys:</span>
<span class="sd">            &#39;avail&#39;: (float) - total available volume for push/pull</span>
<span class="sd">            &#39;priority&#39;: (float) - total (availability * preference)</span>
<span class="sd">                                of attached arcs</span>
<span class="sd">            &#39;allocation&#39;: (dict) - contains all attached arcs in specified</span>
<span class="sd">                            direction and respective (availability * preference)</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; vqip_available_to_pull = my_node.get_direction_arcs()</span>
<span class="sd">        &gt;&gt;&gt; vqip_available_to_push = my_node.get_direction_arcs(&#39;push&#39;)</span>
<span class="sd">        &gt;&gt;&gt; avail_reservoir_vqip = my_node.get_direction_arcs(&#39;pull&#39;,</span>
<span class="sd">                                                      of_type = &#39;Reservoir&#39;)</span>
<span class="sd">        &gt;&gt;&gt; avail_sewer_push_to_sewers = my_node.get_direction_arcs(&#39;push&#39;,</span>
<span class="sd">                                                            of_type = &#39;Sewer&#39;,</span>
<span class="sd">                                                            tag = &#39;Sewer&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialise connected dict</span>
    <span class="n">connected</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;avail&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;priority&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;allocation&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="p">{}}</span>

    <span class="c1"># Get arcs</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">arcs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_direction_arcs</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="n">of_type</span><span class="p">)</span>

    <span class="c1"># Iterate over arcs, updating connected dict</span>
    <span class="k">for</span> <span class="n">arc</span> <span class="ow">in</span> <span class="n">arcs</span><span class="p">:</span>
        <span class="n">avail</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">arc</span><span class="p">,</span> <span class="n">f</span><span class="p">)(</span><span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">avail</span> <span class="o">&lt;</span> <span class="n">constants</span><span class="o">.</span><span class="n">FLOAT_ACCURACY</span><span class="p">:</span>
            <span class="n">avail</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Improves convergence</span>
        <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;avail&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">avail</span>
        <span class="n">preference</span> <span class="o">=</span> <span class="n">arc</span><span class="o">.</span><span class="n">preference</span>
        <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;priority&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">avail</span> <span class="o">*</span> <span class="n">preference</span>
        <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;allocation&quot;</span><span class="p">][</span><span class="n">arc</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">avail</span> <span class="o">*</span> <span class="n">preference</span>
        <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">][</span><span class="n">arc</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">avail</span>

    <span class="k">return</span> <span class="n">connected</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.get_data_input" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_data_input</span><span class="p">(</span><span class="n">var</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Read data from data_input_dict. Keys are tuples with the first entry as the
variable to read and second entry the time.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>var</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of variable</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data read</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_data_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read data from data_input_dict. Keys are tuples with the first entry as the</span>
<span class="sd">    variable to read and second entry the time.</span>

<span class="sd">    Args:</span>
<span class="sd">        var (str): Name of variable</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data read</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_input_dict</span><span class="p">[(</span><span class="n">var</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.get_direction_arcs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_direction_arcs</span><span class="p">(</span><span class="n">direction</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Identify arcs to/from all attached nodes in a given direction.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>direction</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>can be either 'pull' or 'push' to send checks to
receiving or contributing nodes</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>of_type (str or list) </code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional, can be specified to send checks only
to nodes of a given type (must be a subclass in nodes.py)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>f</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Either 'send_pull_check' or 'send_push_check' depending on
direction</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>arcs</code></td>            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of arc objects</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">arcs_to_push_to</span> <span class="o">=</span> <span class="n">my_node</span><span class="o">.</span><span class="n">get_direction_arcs</span><span class="p">(</span><span class="s1">&#39;push&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arcs_to_pull_from</span> <span class="o">=</span> <span class="n">my_node</span><span class="o">.</span><span class="n">get_direction_arcs</span><span class="p">(</span><span class="s1">&#39;pull&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arcs_from_reservoirs</span> <span class="o">=</span> <span class="n">my_node</span><span class="o">.</span><span class="n">get_direction_arcs</span><span class="p">(</span><span class="s1">&#39;pull&#39;</span><span class="p">,</span> <span class="n">of_type</span> <span class="o">=</span>
<span class="go">    &#39;Reservoir&#39;)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_direction_arcs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Identify arcs to/from all attached nodes in a given direction.</span>

<span class="sd">    Args:</span>
<span class="sd">        direction (str): can be either &#39;pull&#39; or &#39;push&#39; to send checks to</span>
<span class="sd">            receiving or contributing nodes</span>
<span class="sd">        of_type (str or list) : optional, can be specified to send checks only</span>
<span class="sd">            to nodes of a given type (must be a subclass in nodes.py)</span>

<span class="sd">    Returns:</span>
<span class="sd">        f (str): Either &#39;send_pull_check&#39; or &#39;send_push_check&#39; depending on</span>
<span class="sd">            direction</span>
<span class="sd">        arcs (list): List of arc objects</span>

<span class="sd">    Raises:</span>
<span class="sd">        Message if no direction is specified</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; arcs_to_push_to = my_node.get_direction_arcs(&#39;push&#39;)</span>
<span class="sd">        &gt;&gt;&gt; arcs_to_pull_from = my_node.get_direction_arcs(&#39;pull&#39;)</span>
<span class="sd">        &gt;&gt;&gt; arcs_from_reservoirs = my_node.get_direction_arcs(&#39;pull&#39;, of_type =</span>
<span class="sd">            &#39;Reservoir&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">of_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Return all arcs</span>
        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s2">&quot;pull&quot;</span><span class="p">:</span>
            <span class="n">arcs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_arcs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">f</span> <span class="o">=</span> <span class="s2">&quot;send_pull_check&quot;</span>
        <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="s2">&quot;push&quot;</span><span class="p">:</span>
            <span class="n">arcs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_arcs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">f</span> <span class="o">=</span> <span class="s2">&quot;send_push_check&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No direction&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">of_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">of_type</span> <span class="o">=</span> <span class="p">[</span><span class="n">of_type</span><span class="p">]</span>

        <span class="c1"># Assign arcs/function based on parameters</span>
        <span class="n">arcs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s2">&quot;pull&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">type_</span> <span class="ow">in</span> <span class="n">of_type</span><span class="p">:</span>
                <span class="n">arcs</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_arcs_type</span><span class="p">[</span><span class="n">type_</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">f</span> <span class="o">=</span> <span class="s2">&quot;send_pull_check&quot;</span>
        <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="s2">&quot;push&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">type_</span> <span class="ow">in</span> <span class="n">of_type</span><span class="p">:</span>
                <span class="n">arcs</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_arcs_type</span><span class="p">[</span><span class="n">type_</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="n">f</span> <span class="o">=</span> <span class="s2">&quot;send_push_check&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No direction&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">arcs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.node_mass_balance" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">node_mass_balance</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Wrapper for core.py/WSIObj/mass_balance. Tracks change in mass balance.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>in_</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A VQIP of the total from mass_balance_in functions</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>ds_</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A VQIP of the total from mass_balance_ds functions</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>out_</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A VQIP of the total from mass_balance_out functions</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">node_in</span><span class="p">,</span> <span class="n">node_out</span><span class="p">,</span> <span class="n">node_ds</span> <span class="o">=</span> <span class="n">my_node</span><span class="o">.</span><span class="n">node_mass_balance</span><span class="p">()</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">node_mass_balance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrapper for core.py/WSIObj/mass_balance. Tracks change in mass balance.</span>

<span class="sd">    Returns:</span>
<span class="sd">        in_ (dict): A VQIP of the total from mass_balance_in functions</span>
<span class="sd">        ds_ (dict): A VQIP of the total from mass_balance_ds functions</span>
<span class="sd">        out_ (dict): A VQIP of the total from mass_balance_out functions</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; node_in, node_out, node_ds = my_node.node_mass_balance()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">in_</span><span class="p">,</span> <span class="n">ds_</span><span class="p">,</span> <span class="n">out_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass_balance</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">in_</span><span class="p">,</span> <span class="n">ds_</span><span class="p">,</span> <span class="n">out_</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.pull_check" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pull_check</span><span class="p">(</span><span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Receives pull check requests from arcs and passes request to query handler.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>vqip</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the VQIP pull check (by default, only the
'volume' key is used). Defaults to None, which returns all available
water to pull.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tag</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional message to direct query_handler which pull
function to call. Defaults to 'default'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;default&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>VQIP available from query_handler</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">water_available</span> <span class="o">=</span> <span class="n">my_node</span><span class="o">.</span><span class="n">pull_check</span><span class="p">({</span><span class="s1">&#39;volume&#39;</span> <span class="p">:</span> <span class="mi">10</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total_water_available</span> <span class="o">=</span> <span class="n">my_node</span><span class="o">.</span><span class="n">pull_check</span><span class="p">()</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pull_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Receives pull check requests from arcs and passes request to query handler.</span>

<span class="sd">    Args:</span>
<span class="sd">        vqip (dict, optional): the VQIP pull check (by default, only the</span>
<span class="sd">            &#39;volume&#39; key is used). Defaults to None, which returns all available</span>
<span class="sd">            water to pull.</span>
<span class="sd">        tag (str, optional): optional message to direct query_handler which pull</span>
<span class="sd">            function to call. Defaults to &#39;default&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (dict): VQIP available from query_handler</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; water_available = my_node.pull_check({&#39;volume&#39; : 10})</span>
<span class="sd">        &gt;&gt;&gt; total_water_available = my_node.pull_check()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_handler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pull_check_handler</span><span class="p">,</span> <span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.pull_check_basic" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pull_check_basic</span><span class="p">(</span><span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Default node check behaviour that treats a node like a junction. Water
available to pull is just the water available to pull from upstream connected
nodes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>vqip</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>VQIP from handler of amount to pull check
(by default, only the 'volume' key is used). Defaults to None (which
returns all availalbe water to pull).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>of_type (str or list) </code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional, can be specified to send checks only
to nodes of a given type (must be a subclass in nodes.py)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tag</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional message to direct query_handler which pull
function to call. Defaults to 'default'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;default&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>VQIP check response of upstream nodes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pull_check_basic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Default node check behaviour that treats a node like a junction. Water</span>
<span class="sd">    available to pull is just the water available to pull from upstream connected</span>
<span class="sd">    nodes.</span>

<span class="sd">    Args:</span>
<span class="sd">        vqip (dict, optional): VQIP from handler of amount to pull check</span>
<span class="sd">            (by default, only the &#39;volume&#39; key is used). Defaults to None (which</span>
<span class="sd">            returns all availalbe water to pull).</span>
<span class="sd">        of_type (str or list) : optional, can be specified to send checks only</span>
<span class="sd">            to nodes of a given type (must be a subclass in nodes.py)</span>
<span class="sd">        tag (str, optional): optional message to direct query_handler which pull</span>
<span class="sd">            function to call. Defaults to &#39;default&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (dict): VQIP check response of upstream nodes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_basic</span><span class="p">(</span><span class="s2">&quot;pull&quot;</span><span class="p">,</span> <span class="n">vqip</span><span class="p">,</span> <span class="n">of_type</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.pull_check_deny" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pull_check_deny</span><span class="p">(</span><span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Responds that no water is available to pull from a check.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>vqip</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A VQIP amount of water requested (ignored)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An empty VQIP indicated no water was pulled</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pull_check_deny</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Responds that no water is available to pull from a check.</span>

<span class="sd">    Args:</span>
<span class="sd">        vqip (dict): A VQIP amount of water requested (ignored)</span>

<span class="sd">    Returns:</span>
<span class="sd">        (dict): An empty VQIP indicated no water was pulled</span>

<span class="sd">    Raises:</span>
<span class="sd">        Message when called, since it would usually occur if a model is</span>
<span class="sd">        improperly connected</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Attempted pull check from deny&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_vqip</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.pull_distributed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pull_distributed</span><span class="p">(</span><span class="n">vqip</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Send pull requests to all (or specified by type) nodes connecting to self.
Iterate until request is met or maximum iterations are hit. Streamlines if only
one in_arc exists.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>vqip</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Total amount to pull (by default, only the
'volume' key is used)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>of_type (str or list) </code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional, can be specified to send checks only
to nodes of a given type (must be a subclass in nodes.py)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tag</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional message to direct query_handler which pull
function to call. Defaults to 'default'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;default&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>pulled</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>VQIP of combined pulled water</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pull_distributed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Send pull requests to all (or specified by type) nodes connecting to self.</span>
<span class="sd">    Iterate until request is met or maximum iterations are hit. Streamlines if only</span>
<span class="sd">    one in_arc exists.</span>

<span class="sd">    Args:</span>
<span class="sd">        vqip (dict): Total amount to pull (by default, only the</span>
<span class="sd">            &#39;volume&#39; key is used)</span>
<span class="sd">        of_type (str or list) : optional, can be specified to send checks only</span>
<span class="sd">            to nodes of a given type (must be a subclass in nodes.py)</span>
<span class="sd">        tag (str, optional): optional message to direct query_handler which pull</span>
<span class="sd">            function to call. Defaults to &#39;default&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pulled (dict): VQIP of combined pulled water</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_arcs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># If only one in_arc, just pull from that</span>
        <span class="k">if</span> <span class="n">of_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pulled</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_arcs</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">send_pull_request</span><span class="p">(</span>
                <span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span>
            <span class="p">[</span><span class="n">x</span> <span class="ow">in</span> <span class="n">of_type</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_arcs_type</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
        <span class="p">):</span>
            <span class="n">pulled</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_arcs</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">send_pull_request</span><span class="p">(</span>
                <span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># No viable out arcs</span>
            <span class="n">pulled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_vqip</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Pull in proportion from connected by priority</span>

        <span class="c1"># Initialise pulled, deficit, connected, iter_</span>
        <span class="n">pulled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_vqip</span><span class="p">()</span>
        <span class="n">deficit</span> <span class="o">=</span> <span class="n">vqip</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span>
        <span class="n">connected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connected</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;pull&quot;</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="n">of_type</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="n">iter_</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Iterate over sending nodes until deficit met</span>
        <span class="k">while</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">deficit</span> <span class="o">&gt;</span> <span class="n">constants</span><span class="o">.</span><span class="n">FLOAT_ACCURACY</span><span class="p">)</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">connected</span><span class="p">[</span><span class="s2">&quot;avail&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">constants</span><span class="o">.</span><span class="n">FLOAT_ACCURACY</span><span class="p">)</span>
        <span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">iter_</span> <span class="o">&lt;</span> <span class="n">constants</span><span class="o">.</span><span class="n">MAXITER</span><span class="p">):</span>
            <span class="c1"># Pull from connected</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">allocation</span> <span class="ow">in</span> <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;allocation&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">received</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_arcs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">send_pull_request</span><span class="p">(</span>
                    <span class="p">{</span><span class="s2">&quot;volume&quot;</span><span class="p">:</span> <span class="n">deficit</span> <span class="o">*</span> <span class="n">allocation</span> <span class="o">/</span> <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;priority&quot;</span><span class="p">]},</span>
                    <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">pulled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sum_vqip</span><span class="p">(</span><span class="n">pulled</span><span class="p">,</span> <span class="n">received</span><span class="p">)</span>

            <span class="c1"># Update deficit, connected and iter_</span>
            <span class="n">deficit</span> <span class="o">=</span> <span class="n">vqip</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">pulled</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span>
            <span class="n">connected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connected</span><span class="p">(</span>
                <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;pull&quot;</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="n">of_type</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span>
            <span class="p">)</span>
            <span class="n">iter_</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">iter_</span> <span class="o">==</span> <span class="n">constants</span><span class="o">.</span><span class="n">MAXITER</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maxiter reached in </span><span class="si">{0}</span><span class="s2"> at </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">pulled</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.pull_set" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pull_set</span><span class="p">(</span><span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Receives pull set requests from arcs and passes request to query handler.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>vqip</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the VQIP pull request (by default, only the 'volume' key is
needed).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tag</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional message to direct query_handler which pull
function to call. Defaults to 'default'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;default&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>VQIP received from query_handler</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">water_received</span> <span class="o">=</span> <span class="n">my_node</span><span class="o">.</span><span class="n">pull_set</span><span class="p">({</span><span class="s1">&#39;volume&#39;</span> <span class="p">:</span> <span class="mi">10</span><span class="p">})</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pull_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Receives pull set requests from arcs and passes request to query handler.</span>

<span class="sd">    Args:</span>
<span class="sd">        vqip (dict): the VQIP pull request (by default, only the &#39;volume&#39; key is</span>
<span class="sd">            needed).</span>
<span class="sd">        tag (str, optional): optional message to direct query_handler which pull</span>
<span class="sd">            function to call. Defaults to &#39;default&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (dict): VQIP received from query_handler</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; water_received = my_node.pull_set({&#39;volume&#39; : 10})</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_handler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pull_set_handler</span><span class="p">,</span> <span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.pull_set_deny" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pull_set_deny</span><span class="p">(</span><span class="n">vqip</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Responds that no water is available to pull from a request.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>vqip</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A VQIP amount of water requested (ignored)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An empty VQIP indicated no water was pulled</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pull_set_deny</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Responds that no water is available to pull from a request.</span>

<span class="sd">    Args:</span>
<span class="sd">        vqip (dict): A VQIP amount of water requested (ignored)</span>

<span class="sd">    Returns:</span>
<span class="sd">        (dict): An empty VQIP indicated no water was pulled</span>

<span class="sd">    Raises:</span>
<span class="sd">        Message when called, since it would usually occur if a model is</span>
<span class="sd">        improperly connected</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Attempted pull set from deny&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_vqip</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.push_check" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">push_check</span><span class="p">(</span><span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Receives push check requests from arcs and passes request to query handler.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>vqip</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the VQIP push check. Defaults to None, which
returns all available capacity to push</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tag</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional message to direct query_handler which pull
function to call. Defaults to 'default'</p>
              </div>
            </td>
            <td>
                  <code>&#39;default&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>VQIP available to push from query_handler</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">total_available_push_capacity</span> <span class="o">=</span> <span class="n">my_node</span><span class="o">.</span><span class="n">push_check</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">available_push_capacity</span> <span class="o">=</span> <span class="n">my_node</span><span class="o">.</span><span class="n">push_check</span><span class="p">(</span><span class="n">wastewater_vqip</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">push_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Receives push check requests from arcs and passes request to query handler.</span>

<span class="sd">    Args:</span>
<span class="sd">        vqip (dict, optional): the VQIP push check. Defaults to None, which</span>
<span class="sd">            returns all available capacity to push</span>
<span class="sd">        tag (str, optional): optional message to direct query_handler which pull</span>
<span class="sd">            function to call. Defaults to &#39;default&#39;</span>

<span class="sd">    Returns:</span>
<span class="sd">        (dict): VQIP available to push from query_handler</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; total_available_push_capacity = my_node.push_check()</span>
<span class="sd">        &gt;&gt;&gt; available_push_capacity = my_node.push_check(wastewater_vqip)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_handler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_check_handler</span><span class="p">,</span> <span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.push_check_accept" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">push_check_accept</span><span class="p">(</span><span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Push check function that accepts all water.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>vqip</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A VQIP that has been pushed (ignored)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>VQIP or an unbounded capacity, indicating all water can be received</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">push_check_accept</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Push check function that accepts all water.</span>

<span class="sd">    Args:</span>
<span class="sd">        vqip (dict, optional): A VQIP that has been pushed (ignored)</span>

<span class="sd">    Returns:</span>
<span class="sd">        (dict): VQIP or an unbounded capacity, indicating all water can be received</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">vqip</span><span class="p">:</span>
        <span class="n">vqip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_vqip</span><span class="p">()</span>
        <span class="n">vqip</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">UNBOUNDED_CAPACITY</span>
    <span class="k">return</span> <span class="n">vqip</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.push_check_basic" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">push_check_basic</span><span class="p">(</span><span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Default node check behaviour that treats a node like a junction. Water
available to push is just the water available to push to downstream connected
nodes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>vqip</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>VQIP from handler of amount to push check.
Defaults to None (which returns all available capacity to push).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>of_type (str or list) </code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional, can be specified to send checks only
to nodes of a given type (must be a subclass in nodes.py)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tag</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional message to direct query_handler which pull
function to call. Defaults to 'default'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;default&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>VQIP check response of downstream nodes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">push_check_basic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Default node check behaviour that treats a node like a junction. Water</span>
<span class="sd">    available to push is just the water available to push to downstream connected</span>
<span class="sd">    nodes.</span>

<span class="sd">    Args:</span>
<span class="sd">        vqip (dict, optional): VQIP from handler of amount to push check.</span>
<span class="sd">            Defaults to None (which returns all available capacity to push).</span>
<span class="sd">        of_type (str or list) : optional, can be specified to send checks only</span>
<span class="sd">            to nodes of a given type (must be a subclass in nodes.py)</span>
<span class="sd">        tag (str, optional): optional message to direct query_handler which pull</span>
<span class="sd">            function to call. Defaults to &#39;default&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (dict): VQIP check response of downstream nodes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_basic</span><span class="p">(</span><span class="s2">&quot;push&quot;</span><span class="p">,</span> <span class="n">vqip</span><span class="p">,</span> <span class="n">of_type</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.push_check_deny" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">push_check_deny</span><span class="p">(</span><span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Responds that no water is available to push in a check.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>vqip</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A VQIP amount of water to push check (ignored)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An empty VQIP indicated no capacity for pushes exists</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">push_check_deny</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Responds that no water is available to push in a check.</span>

<span class="sd">    Args:</span>
<span class="sd">        vqip (dict): A VQIP amount of water to push check (ignored)</span>

<span class="sd">    Returns:</span>
<span class="sd">        (dict): An empty VQIP indicated no capacity for pushes exists</span>

<span class="sd">    Raises:</span>
<span class="sd">        Message when called, since it would usually occur if a model is</span>
<span class="sd">        improperly connected</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Attempted push check to deny&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_vqip</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.push_distributed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">push_distributed</span><span class="p">(</span><span class="n">vqip</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Send push requests to all (or specified by type) nodes connecting to self.
Iterate until request is met or maximum iterations are hit. Streamlines if only
one in_arc exists.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>vqip</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Total amount to push</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>of_type (str or list) </code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional, can be specified to send checks only
to nodes of a given type (must be a subclass in nodes.py)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tag</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional message to direct query_handler which pull
function to call. Defaults to 'default'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;default&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>not_pushed_</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>VQIP of water that cannot be pushed</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">push_distributed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Send push requests to all (or specified by type) nodes connecting to self.</span>
<span class="sd">    Iterate until request is met or maximum iterations are hit. Streamlines if only</span>
<span class="sd">    one in_arc exists.</span>

<span class="sd">    Args:</span>
<span class="sd">        vqip (dict): Total amount to push</span>
<span class="sd">        of_type (str or list) : optional, can be specified to send checks only</span>
<span class="sd">            to nodes of a given type (must be a subclass in nodes.py)</span>
<span class="sd">        tag (str, optional): optional message to direct query_handler which pull</span>
<span class="sd">            function to call. Defaults to &#39;default&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        not_pushed_ (dict): VQIP of water that cannot be pushed</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_arcs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># If only one out_arc, just send the water down that</span>
        <span class="k">if</span> <span class="n">of_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">not_pushed_</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_arcs</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">send_push_request</span><span class="p">(</span>
                <span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span>
            <span class="p">[</span><span class="n">x</span> <span class="ow">in</span> <span class="n">of_type</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_arcs_type</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
        <span class="p">):</span>
            <span class="n">not_pushed_</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">out_arcs</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">send_push_request</span><span class="p">(</span>
                <span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># No viable out arcs</span>
            <span class="n">not_pushed_</span> <span class="o">=</span> <span class="n">vqip</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Push in proportion to connected by priority</span>
        <span class="c1"># Initialise pushed, deficit, connected, iter_</span>
        <span class="n">not_pushed</span> <span class="o">=</span> <span class="n">vqip</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span>
        <span class="n">not_pushed_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy_vqip</span><span class="p">(</span><span class="n">vqip</span><span class="p">)</span>
        <span class="n">connected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connected</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;push&quot;</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="n">of_type</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="n">iter_</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">not_pushed</span> <span class="o">&gt;</span> <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;avail&quot;</span><span class="p">]:</span>
            <span class="c1"># If more water than can be pushed, ignore preference and allocate all</span>
            <span class="c1">#   available based on capacity</span>
            <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;priority&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;avail&quot;</span><span class="p">]</span>
            <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;allocation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>

        <span class="c1"># Iterate over receiving nodes until sent</span>
        <span class="k">while</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">not_pushed</span> <span class="o">&gt;</span> <span class="n">constants</span><span class="o">.</span><span class="n">FLOAT_ACCURACY</span><span class="p">)</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">connected</span><span class="p">[</span><span class="s2">&quot;avail&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">constants</span><span class="o">.</span><span class="n">FLOAT_ACCURACY</span><span class="p">)</span>
            <span class="o">&amp;</span> <span class="p">(</span><span class="n">iter_</span> <span class="o">&lt;</span> <span class="n">constants</span><span class="o">.</span><span class="n">MAXITER</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="c1"># Push to connected</span>
            <span class="n">amount_to_push</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">connected</span><span class="p">[</span><span class="s2">&quot;avail&quot;</span><span class="p">],</span> <span class="n">not_pushed</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">allocation</span> <span class="ow">in</span> <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;allocation&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">to_send</span> <span class="o">=</span> <span class="n">amount_to_push</span> <span class="o">*</span> <span class="n">allocation</span> <span class="o">/</span> <span class="n">connected</span><span class="p">[</span><span class="s2">&quot;priority&quot;</span><span class="p">]</span>
                <span class="n">to_send</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_change_vqip</span><span class="p">(</span><span class="n">not_pushed_</span><span class="p">,</span> <span class="n">to_send</span><span class="p">)</span>
                <span class="n">reply</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_arcs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">send_push_request</span><span class="p">(</span><span class="n">to_send</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>

                <span class="n">sent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_vqip</span><span class="p">(</span><span class="n">to_send</span><span class="p">,</span> <span class="n">reply</span><span class="p">)</span>
                <span class="n">not_pushed_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_vqip</span><span class="p">(</span><span class="n">not_pushed_</span><span class="p">,</span> <span class="n">sent</span><span class="p">)</span>

            <span class="n">not_pushed</span> <span class="o">=</span> <span class="n">not_pushed_</span><span class="p">[</span><span class="s2">&quot;volume&quot;</span><span class="p">]</span>
            <span class="n">connected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connected</span><span class="p">(</span>
                <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;push&quot;</span><span class="p">,</span> <span class="n">of_type</span><span class="o">=</span><span class="n">of_type</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span>
            <span class="p">)</span>
            <span class="n">iter_</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">iter_</span> <span class="o">==</span> <span class="n">constants</span><span class="o">.</span><span class="n">MAXITER</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Maxiter reached in </span><span class="si">{0}</span><span class="s2"> at </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">not_pushed_</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.push_set" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">push_set</span><span class="p">(</span><span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Receives push set requests from arcs and passes request to query handler.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>vqip</code>
            </td>
            <td>
                  <code><span title="_type_">_type_</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the VQIP push request</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tag</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>optional message to direct query_handler which pull
function to call. Defaults to 'default'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;default&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>VQIP not received from query_handler</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>water_not_pushed = my_node.push_set(wastewater_vqip)</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">push_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Receives push set requests from arcs and passes request to query handler.</span>

<span class="sd">    Args:</span>
<span class="sd">        vqip (_type_): the VQIP push request</span>
<span class="sd">        tag (str, optional): optional message to direct query_handler which pull</span>
<span class="sd">            function to call. Defaults to &#39;default&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (dict): VQIP not received from query_handler</span>

<span class="sd">    Examples:</span>
<span class="sd">        water_not_pushed = my_node.push_set(wastewater_vqip)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_handler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">push_set_handler</span><span class="p">,</span> <span class="n">vqip</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.push_set_deny" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">push_set_deny</span><span class="p">(</span><span class="n">vqip</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Responds that no water is available to push in a request.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>vqip</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A VQIP amount of water to push</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>vqip</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Returns the request indicating no water was pushed</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">push_set_deny</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vqip</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Responds that no water is available to push in a request.</span>

<span class="sd">    Args:</span>
<span class="sd">        vqip (dict): A VQIP amount of water to push</span>

<span class="sd">    Returns:</span>
<span class="sd">        vqip (dict): Returns the request indicating no water was pushed</span>

<span class="sd">    Raises:</span>
<span class="sd">        Message when called, since it would usually occur if a model is</span>
<span class="sd">        improperly connected</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Attempted push set to deny&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">vqip</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.query_handler" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">query_handler</span><span class="p">(</span><span class="n">handler</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Sends all push/pull requests/checks using the handler (i.e., ensures the
correct function is used that lines up with 'tag').</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>handler</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>contains all push/pull requests for various tags</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ip</code>
            </td>
            <td>
                  <code><span title="vqip">vqip</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the vqip request</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tag</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>describes what type of push/pull request should be called</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>the VQIP reply from push/pull request</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">query_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">handler</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sends all push/pull requests/checks using the handler (i.e., ensures the</span>
<span class="sd">    correct function is used that lines up with &#39;tag&#39;).</span>

<span class="sd">    Args:</span>
<span class="sd">        handler (dict): contains all push/pull requests for various tags</span>
<span class="sd">        ip (vqip): the vqip request</span>
<span class="sd">        tag (str): describes what type of push/pull request should be called</span>

<span class="sd">    Returns:</span>
<span class="sd">        (dict): the VQIP reply from push/pull request</span>

<span class="sd">    Raises:</span>
<span class="sd">        Message if no functions are defined for tag and if request/check</span>
<span class="sd">        function fails</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">handler</span><span class="p">[</span><span class="n">tag</span><span class="p">](</span><span class="n">ip</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">handler</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No functions defined for &quot;</span> <span class="o">+</span> <span class="n">tag</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">handler</span><span class="p">[</span><span class="n">tag</span><span class="p">](</span><span class="n">ip</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Some other error&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">handler</span><span class="p">[</span><span class="n">tag</span><span class="p">](</span><span class="n">ip</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.reinit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reinit</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Empty function to be written if reinitialisation capability is added.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reinit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Empty function to be written if reinitialisation capability is added.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.total_in" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">total_in</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Sum flow and pollutant amounts entering a node via in_arcs.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>in_</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Summed VQIP of in_arcs</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">node_inflow</span> <span class="o">=</span> <span class="n">my_node</span><span class="o">.</span><span class="n">total_in</span><span class="p">()</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">total_in</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sum flow and pollutant amounts entering a node via in_arcs.</span>

<span class="sd">    Returns:</span>
<span class="sd">        in_ (dict): Summed VQIP of in_arcs</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; node_inflow = my_node.total_in()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">in_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_vqip</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">arc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_arcs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">in_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sum_vqip</span><span class="p">(</span><span class="n">in_</span><span class="p">,</span> <span class="n">arc</span><span class="o">.</span><span class="n">vqip_out</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">in_</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="wsimod.nodes.nodes.Node.total_out" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">total_out</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Sum flow and pollutant amounts leaving a node via out_arcs.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>out_</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Summed VQIP of out_arcs</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">node_outflow</span> <span class="o">=</span> <span class="n">my_node</span><span class="o">.</span><span class="n">total_out</span><span class="p">()</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>wsimod/nodes/nodes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">total_out</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sum flow and pollutant amounts leaving a node via out_arcs.</span>

<span class="sd">    Returns:</span>
<span class="sd">        out_ (dict): Summed VQIP of out_arcs</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; node_outflow = my_node.total_out()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">out_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_vqip</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">arc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_arcs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">out_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sum_vqip</span><span class="p">(</span><span class="n">out_</span><span class="p">,</span> <span class="n">arc</span><span class="o">.</span><span class="n">vqip_in</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">out_</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["content.code.copy"], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>